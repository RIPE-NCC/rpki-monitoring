# Spring Boot always loads `application.yaml`. Afterwards the settings are loaded for the active profile. These are
# merged: By default, `application.yaml` is loaded and `application-default.yaml` extends it.
#
# The default for naming is 'lower-case kebab format' such as 'my.proper-tyname=acme' as recommended in [0].
# [0]: https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config-relaxed-binding
#
spring:
  main.banner-mode: off
  output.ansi.enabled: ALWAYS
  application.name: rpki-monitoring


rrdp:
  interval: 5M
  targets:
    - name: main
      notification-url: https://rrdp.prepdev.ripe.net/notification.xml

rsync:
  repository-url: rsync://rpki.prepdev.ripe.net
  directories:
    - ta
    - repository
  timeout: 30
  interval: 5M
  fetch-ta: true
  base-directory: /tmp/rsync/
  targets:
    - name: rsync
      url: rsync://rpki.prepdev.ripe.net

server:
  port: 9090
  shutdown: graceful

rpkimonitor:
  version: "@gitVersion@"
  internal-api-key-header: "ncc-internal-api-key"

core:
  enable: true
  url: https://core.rpki.prepdev.ripe.net/certification/
  api-key: BAD-TEST-D2Shtf2n5Bwh02P7
  interval: 1m
  initial-delay: 10s

published-objects:
  # The interval at which a full diff on all repositories is collected. Incidentally
  # this _also_ is the interval at which the core repository is tracked.
  full-diff-interval: 5M

logging:
  level:
    web: INFO
    net.ripe.rpki: DEBUG

# Enable prometheus endpoint
management:
  endpoints:
    web:
      exposure:
        include:
          - prometheus
          - info
          - health

---
spring.config.activate.on-profile: local

rrdp:
  interval: 5M
  targets:
    - name: main
      notification-url: https://rrdp.int.ripe.net/notification.xml
      override-hostname: rrdp.int.ripe.net

rsync:
  # *without* the trailing slash
  main-url: rsync://localhost:10873
  directories:
    - ta
    - repository
  timeout: 30
  interval: 5M

core:
  enable: true
  url: http://localhost:8080/certification/
  api-key: BAD-TEST-D2Shtf2n5Bwh02P7

---
spring.config.activate.on-profile: prepdev

rrdp:
  interval: 5M
  targets:
    - name: main
      notification-url: https://rrdp.prepdev.ripe.net/notification.xml
    - name: publish
      notification-url: https://rrdp.int.prepdev.ripe.net/notification.xml
      override-hostname: rrdp.int.prepdev.ripe.net
    - name: cloudflare
      notification-url: https://rrdp.prepdev.ripe.net/notification.xml
      connect-to:
        rrdp.prepdev.ripe.net: rrdp.prepdev.ripe.net.cdn.cloudflare.net
    - name: akamai
      notification-url: https://rrdp.prepdev.ripe.net/notification.xml
      connect-to:
        rrdp.prepdev.ripe.net: rrdp.prepdev.ripe.net.akamaized.net

rsync:
  repository-url: rsync://rpki.prepdev.ripe.net
  directories:
    - ta
    - repository
  timeout: 30
  interval: 5M
  base-directory: /tmp/rsync/
  targets:
    - name: rsync
      url: rsync://rpki.prepdev.ripe.net

core:
  enable: true
  url: https://core.rpki.prepdev.ripe.net/certification/

---
spring.config.activate.on-profile: production

rrdp:
  interval: 5M
  targets:
    - name: main
      notification-url: https://rrdp.ripe.net/notification.xml
    - name: publish
      notification-url: https://rrdp.int.ripe.net/notification.xml
      override-hostname: rrdp.int.ripe.net
    - name: cloudflare
      notification-url: https://rrdp.ripe.net/notification.xml
      connect-to:
        rrdp.ripe.net: rrdp.ripe.net.cdn.cloudflare.net
    - name: akamai
      notification-url: https://rrdp.ripe.net/notification.xml
      connect-to:
        rrdp.ripe.net: rrdp.ripe.net.akamaized.net
    - name: beanstalk
      notification-url: https://rrdp.ripe.net/notification.xml
      connect-to:
        rrdp.ripe.net: d2imhg7olcem40.cloudfront.net

rsync:
  repository-url: rsync://rpki.ripe.net
  directories:
    - ta
    - repository
  base-directory: /tmp/rsync/
  timeout: 30
  interval: 5M
  targets:
    - name: rsync
      url: rsync://rpki.ripe.net

core:
  enable: true
  url: https://core.rpki.ripe.net/certification/

---
spring.config.activate.on-profile: paas-prepdev

rrdp:
  interval: 5M
  targets:
    - name: main
      notification-url: https://rrdp.paas.rpki.prepdev.ripe.net/notification.xml
    - name: krill-sync
      notification-url: https://rrdp.int.paas.rpki.prepdev.ripe.net/notification.xml
      override-hostname: rrdp.int.paas.rpki.prepdev.ripe.net
    - name: krill-internal
      notification-url: https://internal.paas.rpki.prepdev.ripe.net/notification.xml
      override-hostname: internal.paas.rpki.prepdev.ripe.net

rsync:
  repository-url: rsync://rsync.paas.rpki.prepdev.ripe.net
  directories:
    - repository
  base-directory: /tmp/rsync/
  fetch-ta: false
  timeout: 30
  interval: 5M
  targets:
    - name: rsync
      url: rsync://rsync.paas.rpki.prepdev.ripe.net

core:
  enable: false

---
spring.config.activate.on-profile: paas-production

rrdp:
  interval: 5M
  targets:
    - name: main
      notification-url: https://rrdp.paas.rpki.ripe.net/notification.xml
    - name: krill-sync
      notification-url: https://rrdp.int.paas.rpki.ripe.net/notification.xml
      override-hostname: rrdp.int.paas.rpki.ripe.net
    - name: krill-internal
      notification-url: https://internal.paas.rpki.ripe.net/notification.xml
      override-hostname: internal.paas.rpki.ripe.net
    - name: cloudflare
      notification-url: https://rrdp.paas.rpki.ripe.net/notification.xml
      connect-to:
        rrdp.paas.rpki.ripe.net: rrdp.paas.rpki.ripe.net.cdn.cloudflare.net

rsync:
  repository-url: rsync://rsync.paas.rpki.ripe.net
  directories:
    - repository
  base-directory: /tmp/rsync/
  fetch-ta: false
  timeout: 30
  interval: 5M
  targets:
    - name: rsync
      url: rsync://rsync.paas.rpki.ripe.net

core:
  enable: false
